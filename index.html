<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>⚡ HyperSubtitle.AI ⚡</title>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');body {
  margin: 0;
  padding: 0;
  background: #0f0f0f;
  font-family: 'Share Tech Mono', monospace;
  color: #00fff7;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  min-height: 100vh;
}

header {
  text-align: center;
  padding: 2rem 1rem;
  font-size: 2rem;
  background: linear-gradient(to right, #00fff7, #7f00ff);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  text-shadow: 0 0 10px #00fff7;
}

.container {
  background: rgba(255, 255, 255, 0.05);
  backdrop-filter: blur(10px);
  border: 1px solid #00fff799;
  border-radius: 16px;
  padding: 2rem;
  margin: 1rem;
  width: 90%;
  max-width: 600px;
  box-shadow: 0 0 15px #00fff744;
}

.upload-box {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

input[type="file"], select, button {
  padding: 1rem;
  background: #1c1c1c;
  border: 1px solid #00fff7;
  border-radius: 8px;
  color: #00fff7;
  font-size: 1rem;
  outline: none;
  cursor: pointer;
}

button:hover {
  background: #00fff722;
}

video {
  width: 100%;
  margin-top: 1rem;
  border-radius: 12px;
  border: 1px solid #00fff7;
}

.output {
  margin-top: 2rem;
  background: #1a1a1a;
  padding: 1rem;
  border-radius: 12px;
  border: 1px solid #00fff7;
  max-height: 200px;
  overflow-y: auto;
}

.output p {
  color: #fff;
}

.progress-container {
  width: 100%;
  margin-top: 1rem;
  background: #222;
  border-radius: 10px;
  overflow: hidden;
  border: 1px solid #00fff7;
}

.progress-bar {
  height: 20px;
  background: linear-gradient(to right, #00fff7, #7f00ff);
  width: 0%;
  transition: width 0.3s ease;
}

  </style>
</head>
<body>
  <header>⚡ HyperSubtitle.AI ⚡</header>  <div class="container">
    <div class="upload-box">
      <input type="file" id="videoInput" accept="video/*">
      <select id="languageSelect">
        <option value="en">Translate to English</option>
        <option value="es">Spanish</option>
        <option value="fr">French</option>
        <option value="ur">Urdu</option>
      </select>
      <button onclick="startProcessing()">Start Subtitle Translation</button>
    </div><video id="videoPreview" controls></video>
<canvas id="videoCanvas" style="display:none;"></canvas>

<div class="progress-container">
  <div class="progress-bar" id="progressBar"></div>
</div>

<div class="output" id="ocrOutput">
  <p><em>Detected subtitles and translations will appear here...</em></p>
</div>

<button onclick="downloadSRT()">⬇️ Download Translated SRT</button>

  </div>  <script>
    const videoInput = document.getElementById('videoInput');
    const videoPreview = document.getElementById('videoPreview');
    const ocrOutput = document.getElementById('ocrOutput');
    const canvas = document.getElementById('videoCanvas');
    const ctx = canvas.getContext('2d');
    const languageSelect = document.getElementById('languageSelect');
    const progressBar = document.getElementById('progressBar');

    let extractedCaptions = [];

    videoInput.addEventListener('change', function() {
      const file = this.files[0];
      if (file) {
        videoPreview.src = URL.createObjectURL(file);
      }
    });

    async function translateText(text, targetLang) {
      const res = await fetch("https://libretranslate.de/translate", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          q: text,
          source: "auto",
          target: targetLang,
          format: "text"
        })
      });
      const data = await res.json();
      return data.translatedText;
    }

    async function startProcessing() {
      extractedCaptions = [];
      const duration = videoPreview.duration;
      const frameInterval = 2; // seconds
      const totalFrames = Math.floor(duration / frameInterval);
      ocrOutput.innerHTML = "";

      for (let i = 0; i < totalFrames; i++) {
        const t = i * frameInterval;
        videoPreview.currentTime = t;
        await new Promise(resolve => videoPreview.onseeked = resolve);

        canvas.width = videoPreview.videoWidth;
        canvas.height = videoPreview.videoHeight;
        ctx.drawImage(videoPreview, 0, 0, canvas.width, canvas.height);

        const dataUrl = canvas.toDataURL();
        const result = await Tesseract.recognize(dataUrl, 'eng');
        const rawText = result.data.text.trim();

        if (rawText) {
          const cleanedText = rawText.replace(/\n/g, ' ').replace(/\s+/g, ' ').trim();
          const translated = await translateText(cleanedText, languageSelect.value);
          extractedCaptions.push({
            start: t,
            end: t + frameInterval,
            text: translated
          });
          ocrOutput.innerHTML += `<p><strong>[${t}s]</strong> ${translated}</p>`;
        }
        progressBar.style.width = `${((i + 1) / totalFrames) * 100}%`;
      }
    }

    function toSRTTime(seconds) {
      const date = new Date(null);
      date.setSeconds(seconds);
      return date.toISOString().substr(11, 8) + ",000";
    }

    function downloadSRT() {
      let srt = "";
      extractedCaptions.forEach((cap, idx) => {
        srt += `${idx + 1}\n${toSRTTime(cap.start)} --> ${toSRTTime(cap.end)}\n${cap.text}\n\n`;
      });
      const blob = new Blob([srt], { type: 'text/plain' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'translated_subtitles.srt';
      a.click();
    }
  </script></body>
</html>